{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Tech Notes Tech Notes Run mkdocs to generate sites htmls Run mkdocs to generate sites htmls mkdocs build mkdocs serve # publish to git pages mkdocs gh-deploy It will be published on https://tanalex.github.io/tech_notes/","title":"Home"},{"location":"#tech-notes","text":"Tech Notes Run mkdocs to generate sites htmls","title":"Tech Notes"},{"location":"#run-mkdocs-to-generate-sites-htmls","text":"mkdocs build mkdocs serve # publish to git pages mkdocs gh-deploy It will be published on https://tanalex.github.io/tech_notes/","title":"Run mkdocs to generate sites htmls"},{"location":"AWS/AWS.Notes/","text":"AWS Note VPC related Each VPC can have only one IGW (Internet Gateway) Need to create Security Group to allow traffice from Public Subnet to talk to Private Subnet Allow ICMP and Open port to the Public Subnet Allow port 80, 443, 3306 and 22 to Public Subnet Nat Instance Note Must be created in public subnet, use public SG Have to disable 'Source and Destination Check' By click instance => Actions => Networking => Source/Dest-Check Add 0.0.0.0/0 to that NAT instance to the default route table of VPC NAT Gateway NAT Gateway requires one Subnet and one EIP(Elastic IP) Add 0.0.0.0/0 to that NAT Gateway to the default/main route table of VPC VPC Endpoint Create Endpoint and pick com.aws.us-west-2.s3 That will create a new route in the main routing table Note: This can take quite long to populate the new route On the EC2 Instance with S3 role attached, run aws s3 ls --region us-west-2 EC2 related EC2 Instance role Add a IAM role and assign permissions Change EC2 Instance to use the role AutoScaling Group Pick VPC and Subnets If use scaling policies, set Instance warm up (Instance needs xx seconds to warm up after scaling) Send notification after scaling Launch Config Pick IAM role for the instance Can pick Assign public IP to every instance or Do Not assign public IP or Only assing a public IP to instances launched in the default VPC and subnet (defult) Route53 Simple routing Create Record Set Pick Type: A - IPv4 Address Pick \"No\" for Alias Put a list of IPs to \"Value:\" Choose \"Simple\" for Routing Policy Weighted routing Create 1st Record Set Pick Type: A- IPv4 Adress Choose \"Weighted\" for Routing Policy Give a weight, say 30 Give a name (Set ID) Create 2nd Record Set Pick Type: A- IPv4 Adress Choose \"Weighted\" for Routing Policy Give a weight, say 20 Give a name (Set ID) Route53 Health Check Health check can be added to any of the Record Set Can set normal or faster check (every 10 sec)","title":"Note"},{"location":"AWS/AWS.Notes/#aws-note","text":"","title":"AWS Note"},{"location":"AWS/AWS.Notes/#vpc-related","text":"Each VPC can have only one IGW (Internet Gateway) Need to create Security Group to allow traffice from Public Subnet to talk to Private Subnet Allow ICMP and Open port to the Public Subnet Allow port 80, 443, 3306 and 22 to Public Subnet Nat Instance Note Must be created in public subnet, use public SG Have to disable 'Source and Destination Check' By click instance => Actions => Networking => Source/Dest-Check Add 0.0.0.0/0 to that NAT instance to the default route table of VPC NAT Gateway NAT Gateway requires one Subnet and one EIP(Elastic IP) Add 0.0.0.0/0 to that NAT Gateway to the default/main route table of VPC VPC Endpoint Create Endpoint and pick com.aws.us-west-2.s3 That will create a new route in the main routing table Note: This can take quite long to populate the new route On the EC2 Instance with S3 role attached, run aws s3 ls --region us-west-2","title":"VPC related"},{"location":"AWS/AWS.Notes/#ec2-related","text":"","title":"EC2 related"},{"location":"AWS/AWS.Notes/#ec2-instance-role","text":"Add a IAM role and assign permissions Change EC2 Instance to use the role","title":"EC2 Instance role"},{"location":"AWS/AWS.Notes/#autoscaling-group","text":"Pick VPC and Subnets If use scaling policies, set Instance warm up (Instance needs xx seconds to warm up after scaling) Send notification after scaling","title":"AutoScaling Group"},{"location":"AWS/AWS.Notes/#launch-config","text":"Pick IAM role for the instance Can pick Assign public IP to every instance or Do Not assign public IP or Only assing a public IP to instances launched in the default VPC and subnet (defult)","title":"Launch Config"},{"location":"AWS/AWS.Notes/#route53","text":"","title":"Route53"},{"location":"AWS/AWS.Notes/#simple-routing","text":"Create Record Set Pick Type: A - IPv4 Address Pick \"No\" for Alias Put a list of IPs to \"Value:\" Choose \"Simple\" for Routing Policy","title":"Simple routing"},{"location":"AWS/AWS.Notes/#weighted-routing","text":"Create 1st Record Set Pick Type: A- IPv4 Adress Choose \"Weighted\" for Routing Policy Give a weight, say 30 Give a name (Set ID) Create 2nd Record Set Pick Type: A- IPv4 Adress Choose \"Weighted\" for Routing Policy Give a weight, say 20 Give a name (Set ID)","title":"Weighted routing"},{"location":"AWS/AWS.Notes/#route53-health-check","text":"Health check can be added to any of the Record Set Can set normal or faster check (every 10 sec)","title":"Route53 Health Check"},{"location":"AWS/CloudFormation-cf-functions/","text":"CloudFormation cf-init, cf-signal etc Blog reference https://medium.com/faun/aws-cloudformation-cfn-signal-8cf27d79da14 Install latest cf scripts apt install python-pip pip install https://s3.amazonaws.com/cloudformation-examples/aws-cfn-bootstrap-latest.tar.gz Wait condition CreationPolicy: ResourceSignal: Timeout: PT5M This would define a policy to create the EC2 instance. The timeout as PT5M means that it would wait for 5 minutes for the CFN-Signal. If the EC2 Instance doesn\u2019t receive the CFN-Signal within the time period, the EC2 instance creation would fail and roll back the stack Use cf-signal to notify the installation was successful myec2instance: Type: 'AWS::EC2::Instance' Properties: DisableApiTermination: 'false' InstanceInitiatedShutdownBehavior: stop ImageId: !Ref AMIid InstanceType: t2.micro KeyName: !Ref KeyPairName Tags: - Key: Name Value: ec2instance NetworkInterfaces: - DeleteOnTermination: 'true' Description: Primary network interface DeviceIndex: 0 SubnetId: !Ref subnet GroupSet: - !Ref securitygroup UserData: !Base64 'Fn::Sub': | #cloud-boothook #!/bin/bash export PATH=~/.local/bin:$PATH apt-get update apt install python-pip pip install https://s3.amazonaws.com/cloudformation-examples/aws-cfn-bootstrap-latest.tar.gz /usr/local/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource myec2instance --region ${AWS::Region} CreationPolicy: ResourceSignal: Timeout: PT5M","title":"CloudFormation cf-init, cf-signal etc"},{"location":"AWS/CloudFormation-cf-functions/#cloudformation-cf-init-cf-signal-etc","text":"","title":"CloudFormation cf-init, cf-signal etc"},{"location":"AWS/CloudFormation-cf-functions/#blog-reference","text":"https://medium.com/faun/aws-cloudformation-cfn-signal-8cf27d79da14","title":"Blog reference"},{"location":"AWS/CloudFormation-cf-functions/#install-latest-cf-scripts","text":"apt install python-pip pip install https://s3.amazonaws.com/cloudformation-examples/aws-cfn-bootstrap-latest.tar.gz","title":"Install latest cf scripts"},{"location":"AWS/CloudFormation-cf-functions/#wait-condition","text":"CreationPolicy: ResourceSignal: Timeout: PT5M This would define a policy to create the EC2 instance. The timeout as PT5M means that it would wait for 5 minutes for the CFN-Signal. If the EC2 Instance doesn\u2019t receive the CFN-Signal within the time period, the EC2 instance creation would fail and roll back the stack","title":"Wait condition"},{"location":"AWS/CloudFormation-cf-functions/#use-cf-signal-to-notify-the-installation-was-successful","text":"myec2instance: Type: 'AWS::EC2::Instance' Properties: DisableApiTermination: 'false' InstanceInitiatedShutdownBehavior: stop ImageId: !Ref AMIid InstanceType: t2.micro KeyName: !Ref KeyPairName Tags: - Key: Name Value: ec2instance NetworkInterfaces: - DeleteOnTermination: 'true' Description: Primary network interface DeviceIndex: 0 SubnetId: !Ref subnet GroupSet: - !Ref securitygroup UserData: !Base64 'Fn::Sub': | #cloud-boothook #!/bin/bash export PATH=~/.local/bin:$PATH apt-get update apt install python-pip pip install https://s3.amazonaws.com/cloudformation-examples/aws-cfn-bootstrap-latest.tar.gz /usr/local/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource myec2instance --region ${AWS::Region} CreationPolicy: ResourceSignal: Timeout: PT5M","title":"Use cf-signal to notify the installation was successful"},{"location":"AWS/CloudFormation/","text":"CloudFormation note https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/gettingstarted.templatebasics.html A tutorial guide: https://medium.com/boltops/a-simple-introduction-to-aws-cloudformation-part-1-1694a41ae59d Basic structure Resources Type Properties Functions !Ref Resources: Ec2Instance: Type: 'AWS::EC2::Instance' Properties: SecurityGroups: - !Ref InstanceSecurityGroup KeyName: mykey ImageId: '' InstanceSecurityGroup: Type: 'AWS::EC2::SecurityGroup' Properties: GroupDescription: Enable SSH access via port 22 SecurityGroupIngress: - IpProtocol: tcp FromPort: '22' ToPort: '22' CidrIp: 0.0.0.0/0 Parameters Parameters: KeyName: Description: The EC2 Key Pair to allow SSH access to the instance Type: 'AWS::EC2::KeyPair::KeyName' Resources: Ec2Instance: Type: 'AWS::EC2::Instance' Properties: SecurityGroups: - !Ref InstanceSecurityGroup - MyExistingSecurityGroup KeyName: !Ref KeyName ImageId: ami-7a11e213 InstanceSecurityGroup: Type: 'AWS::EC2::SecurityGroup' Properties: GroupDescription: Enable SSH access via port 22 SecurityGroupIngress: - IpProtocol: tcp FromPort: '22' ToPort: '22' CidrIp: 0.0.0.0/0 Get parameters like Ansible var_prompt Parameters: KeyName: Description: Name of an existing EC2 KeyPair to enable SSH access into the WordPress web server Type: AWS::EC2::KeyPair::KeyName WordPressUser: Default: admin NoEcho: true Description: The WordPress database admin account user name Type: String MinLength: 1 MaxLength: 16 AllowedPattern: \"[a-zA-Z][a-zA-Z0-9]*\" WebServerPort: Default: 8888 Description: TCP/IP port for the WordPress web server Type: Number MinValue: 1 MaxValue: 65535 Constraints using AllowedValues \"Parameters\" : { \"InstanceType\" : { \"Description\" : \"WebServer EC2 instance type\", \"Type\" : \"String\", \"Default\" : \"t2.small\", \"AllowedValues\" : [ \"t1.micro\", \"t2.nano\", ... ... ], \"ConstraintDescription\" : \"must be a valid EC2 instance type.\" } }, The Fn::GetAtt function takes two parameters, the logical name of the resource and the name of the attribute to be retrieved. For a full list of available attributes for resources, see Fn::GetAtt. You'll notice that the Fn::GetAtt function lists its two parameters in an array. For functions that take multiple parameters, you use an array to specify their parameters. Resources: myBucket: Type: 'AWS::S3::Bucket' myDistribution: Type: 'AWS::CloudFront::Distribution' Properties: DistributionConfig: Origins: - DomainName: !GetAtt - myBucket - DomainName Id: myS3Origin S3OriginConfig: {} Enabled: 'true' DefaultCacheBehavior: TargetOriginId: myS3Origin ForwardedValues: QueryString: 'false' ViewerProtocolPolicy: allow-all use the Fn::FindInMap function passing the name of the map, the value used to find the mapped value, and the label of the mapped value you want to return. Parameters: KeyName: Description: Name of an existing EC2 KeyPair to enable SSH access to the instance Type: String Mappings: RegionMap: us-east-1: AMI: ami-76f0061f us-west-1: AMI: ami-655a0a20 eu-west-1: AMI: ami-7fd4e10b ap-southeast-1: AMI: ami-72621c20 ap-northeast-1: AMI: ami-8e08a38f Resources: Ec2Instance: Type: 'AWS::EC2::Instance' Properties: KeyName: !Ref KeyName ImageId: !FindInMap - RegionMap - !Ref 'AWS::Region' - AMI UserData: !Base64 '80' !Join function and outputs Outputs: InstallURL: Value: !Join - '' - - 'http://' - !GetAtt - ElasticLoadBalancer - DNSName - /wp-admin/install.php Description: Installation URL of the WordPress website WebsiteURL: Value: !Join - '' - - 'http://' - !GetAtt - ElasticLoadBalancer - DNSName","title":"CloudFormation"},{"location":"AWS/CloudFormation/#cloudformation-note","text":"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/gettingstarted.templatebasics.html A tutorial guide: https://medium.com/boltops/a-simple-introduction-to-aws-cloudformation-part-1-1694a41ae59d","title":"CloudFormation note"},{"location":"AWS/CloudFormation/#basic-structure","text":"Resources Type Properties Functions !Ref Resources: Ec2Instance: Type: 'AWS::EC2::Instance' Properties: SecurityGroups: - !Ref InstanceSecurityGroup KeyName: mykey ImageId: '' InstanceSecurityGroup: Type: 'AWS::EC2::SecurityGroup' Properties: GroupDescription: Enable SSH access via port 22 SecurityGroupIngress: - IpProtocol: tcp FromPort: '22' ToPort: '22' CidrIp: 0.0.0.0/0 Parameters Parameters: KeyName: Description: The EC2 Key Pair to allow SSH access to the instance Type: 'AWS::EC2::KeyPair::KeyName' Resources: Ec2Instance: Type: 'AWS::EC2::Instance' Properties: SecurityGroups: - !Ref InstanceSecurityGroup - MyExistingSecurityGroup KeyName: !Ref KeyName ImageId: ami-7a11e213 InstanceSecurityGroup: Type: 'AWS::EC2::SecurityGroup' Properties: GroupDescription: Enable SSH access via port 22 SecurityGroupIngress: - IpProtocol: tcp FromPort: '22' ToPort: '22' CidrIp: 0.0.0.0/0 Get parameters like Ansible var_prompt Parameters: KeyName: Description: Name of an existing EC2 KeyPair to enable SSH access into the WordPress web server Type: AWS::EC2::KeyPair::KeyName WordPressUser: Default: admin NoEcho: true Description: The WordPress database admin account user name Type: String MinLength: 1 MaxLength: 16 AllowedPattern: \"[a-zA-Z][a-zA-Z0-9]*\" WebServerPort: Default: 8888 Description: TCP/IP port for the WordPress web server Type: Number MinValue: 1 MaxValue: 65535 Constraints using AllowedValues \"Parameters\" : { \"InstanceType\" : { \"Description\" : \"WebServer EC2 instance type\", \"Type\" : \"String\", \"Default\" : \"t2.small\", \"AllowedValues\" : [ \"t1.micro\", \"t2.nano\", ... ... ], \"ConstraintDescription\" : \"must be a valid EC2 instance type.\" } },","title":"Basic structure"},{"location":"AWS/CloudFormation/#the-fngetatt-function","text":"takes two parameters, the logical name of the resource and the name of the attribute to be retrieved. For a full list of available attributes for resources, see Fn::GetAtt. You'll notice that the Fn::GetAtt function lists its two parameters in an array. For functions that take multiple parameters, you use an array to specify their parameters. Resources: myBucket: Type: 'AWS::S3::Bucket' myDistribution: Type: 'AWS::CloudFront::Distribution' Properties: DistributionConfig: Origins: - DomainName: !GetAtt - myBucket - DomainName Id: myS3Origin S3OriginConfig: {} Enabled: 'true' DefaultCacheBehavior: TargetOriginId: myS3Origin ForwardedValues: QueryString: 'false' ViewerProtocolPolicy: allow-all","title":"The Fn::GetAtt function"},{"location":"AWS/CloudFormation/#use-the-fnfindinmap-function","text":"passing the name of the map, the value used to find the mapped value, and the label of the mapped value you want to return. Parameters: KeyName: Description: Name of an existing EC2 KeyPair to enable SSH access to the instance Type: String Mappings: RegionMap: us-east-1: AMI: ami-76f0061f us-west-1: AMI: ami-655a0a20 eu-west-1: AMI: ami-7fd4e10b ap-southeast-1: AMI: ami-72621c20 ap-northeast-1: AMI: ami-8e08a38f Resources: Ec2Instance: Type: 'AWS::EC2::Instance' Properties: KeyName: !Ref KeyName ImageId: !FindInMap - RegionMap - !Ref 'AWS::Region' - AMI UserData: !Base64 '80'","title":"use the Fn::FindInMap function"},{"location":"AWS/CloudFormation/#join-function-and-outputs","text":"Outputs: InstallURL: Value: !Join - '' - - 'http://' - !GetAtt - ElasticLoadBalancer - DNSName - /wp-admin/install.php Description: Installation URL of the WordPress website WebsiteURL: Value: !Join - '' - - 'http://' - !GetAtt - ElasticLoadBalancer - DNSName","title":"!Join function and outputs"},{"location":"AWS/VPN/","text":"VPN solution using EC2 Instance acting as gateway https://www.webdigi.co.uk/blog/2015/how-to-setup-your-own-private-secure-free-vpn-on-the-amazon-aws-cloud-in-10-minutes/ https://github.com/webdigi/AWS-VPN-Server-Setup/blob/master/Unified-Cloud-Formation.yaml","title":"VPN"},{"location":"AWS/VPN/#vpn-solution-using-ec2-instance-acting-as-gateway","text":"https://www.webdigi.co.uk/blog/2015/how-to-setup-your-own-private-secure-free-vpn-on-the-amazon-aws-cloud-in-10-minutes/ https://github.com/webdigi/AWS-VPN-Server-Setup/blob/master/Unified-Cloud-Formation.yaml","title":"VPN solution using EC2 Instance acting as gateway"},{"location":"AWS/auto-scaling-group/","text":"AutoScaling Group Rolling update policy https://medium.com/faun/rolling-updates-with-aws-autoscaling-groups-ecf7b5a95c52 SampleAutoScalingGroup: Type: 'AWS::AutoScaling::AutoScalingGroup' Properties: LaunchConfigurationName: !Ref SampleLaunchConfiguration DesiredCapacity: 2 MinSize: 1 MaxSize: 5 UpdatePolicy: AutoScalingRollingUpdate: MaxBatchSize: '2' MinInstancesInService: '2' PauseTime: PT10M WaitOnResourceSignals: true Use terraform with CloudFormation https://medium.com/@endofcake/using-terraform-for-zero-downtime-updates-of-an-auto-scaling-group-in-aws-60faca582664 userdata to detect if EC2 has finished provisioning #!/bin/bash set -euo pipefail <...> echo \"Checking that agent is running\" until $(curl --output /dev/null --silent --head --fail http://localhost:51678/v1/metadata); do printf '.' sleep 1 done exit_code=$? printf \"\\nDone\\n\" # Can't signal back if the stack is in UPDATE_COMPLETE state, so ignore failures to do so. # CFN will roll back if it expects the signal but doesn't get it anyway. echo \"Reporting $exit_code exit code to Cloudformation\" /opt/aws/bin/cfn-signal \\ --exit-code \"$exit_code\" \\ --stack \"$CFN_STACK\" \\ --resource ASG \\ --region \"$REGION\" || true","title":"AutoScaling Group"},{"location":"AWS/auto-scaling-group/#autoscaling-group","text":"","title":"AutoScaling Group"},{"location":"AWS/auto-scaling-group/#rolling-update-policy","text":"https://medium.com/faun/rolling-updates-with-aws-autoscaling-groups-ecf7b5a95c52 SampleAutoScalingGroup: Type: 'AWS::AutoScaling::AutoScalingGroup' Properties: LaunchConfigurationName: !Ref SampleLaunchConfiguration DesiredCapacity: 2 MinSize: 1 MaxSize: 5 UpdatePolicy: AutoScalingRollingUpdate: MaxBatchSize: '2' MinInstancesInService: '2' PauseTime: PT10M WaitOnResourceSignals: true","title":"Rolling update policy"},{"location":"AWS/auto-scaling-group/#use-terraform-with-cloudformation","text":"https://medium.com/@endofcake/using-terraform-for-zero-downtime-updates-of-an-auto-scaling-group-in-aws-60faca582664 userdata to detect if EC2 has finished provisioning #!/bin/bash set -euo pipefail <...> echo \"Checking that agent is running\" until $(curl --output /dev/null --silent --head --fail http://localhost:51678/v1/metadata); do printf '.' sleep 1 done exit_code=$? printf \"\\nDone\\n\" # Can't signal back if the stack is in UPDATE_COMPLETE state, so ignore failures to do so. # CFN will roll back if it expects the signal but doesn't get it anyway. echo \"Reporting $exit_code exit code to Cloudformation\" /opt/aws/bin/cfn-signal \\ --exit-code \"$exit_code\" \\ --stack \"$CFN_STACK\" \\ --resource ASG \\ --region \"$REGION\" || true","title":"Use terraform with CloudFormation"},{"location":"CSharp/","text":"C# Note Flagged enum [Flags] public enum Tag { None =0x0, Tip =0x1, Example=0x2 } snippet.Tag = Tag.Tip | Tag.Example Cast vs As CAST DESCRIPTION Tree tree = (Tree)obj Use this when you expect that obj will only ever be of type Tree. If obj is not a Tree, an InvalidCast exception will be raised. Tree tree = obj as Tree Use this when you anticipate that obj may or may not be a Tree. If obj is not a Tree, a null value will be assigned to tree. Always follow an \u201cas\u201d cast with conditional logic to properly handle the case where null is returned. Only use this style of conversion when necessary, since it necessitates conditional handling of the return value. This extra code creates opportunities for more bugs and makes the code more difficult to read and debug. Model validation by ModelState.IsValid Add annotation like [Required] etc to model Add this in the controller to check if [FromBody] parsing is successful or not public async Task<IActionResult> CreateVehicle([FromBody] vehicle){ if (!ModelState.IsValid) return BadRequest(ModelState); ... }","title":"Quick Note"},{"location":"CSharp/#c-note","text":"","title":"C# Note"},{"location":"CSharp/#flagged-enum","text":"[Flags] public enum Tag { None =0x0, Tip =0x1, Example=0x2 } snippet.Tag = Tag.Tip | Tag.Example","title":"Flagged enum"},{"location":"CSharp/#cast-vs-as","text":"CAST DESCRIPTION Tree tree = (Tree)obj Use this when you expect that obj will only ever be of type Tree. If obj is not a Tree, an InvalidCast exception will be raised. Tree tree = obj as Tree Use this when you anticipate that obj may or may not be a Tree. If obj is not a Tree, a null value will be assigned to tree. Always follow an \u201cas\u201d cast with conditional logic to properly handle the case where null is returned. Only use this style of conversion when necessary, since it necessitates conditional handling of the return value. This extra code creates opportunities for more bugs and makes the code more difficult to read and debug.","title":"Cast vs As"},{"location":"CSharp/#model-validation-by-modelstateisvalid","text":"Add annotation like [Required] etc to model Add this in the controller to check if [FromBody] parsing is successful or not public async Task<IActionResult> CreateVehicle([FromBody] vehicle){ if (!ModelState.IsValid) return BadRequest(ModelState); ... }","title":"Model validation by ModelState.IsValid"},{"location":"CSharp/MemberExpression/","text":"Use MemberExpression and PropertyInfo to get object's property to work on Get property's custom annotation using System; using System.ComponentModel; using System.Linq.Expressions; public class Foo { [Description( \"The first property.\" )] public int property1; [Description( \"The second property.\" )] public string property2; } class Program { static string GetDescription<T>( Expression<Func<T>> expr ) { var mexpr = expr.Body as MemberExpression; if( mexpr == null ) return null; if( mexpr.Member == null ) return null; object[] attrs = mexpr.Member.GetCustomAttributes( typeof( DescriptionAttribute ), false ); if( attrs == null || attrs.Length == 0 ) return null; DescriptionAttribute desc = attrs[0] as DescriptionAttribute; if( desc == null ) return null; return desc.Description; } static void Main( string[] args ) { Foo foo = new Foo(); Console.WriteLine( GetDescription( () => foo.property1 ) ); Console.WriteLine( GetDescription( () => foo.property2 ) ); } } Use MemberExpression and Compile to get the value public static string Meth<T>(Expression<Func<T>> expression) { var name = ((MemberExpression)expression.Body).Member.Name; var value = expression.Compile()(); return string.Format(\"{0} - {1}\", name, value); } Meth(() => YourObject.Property); Use getValue and setValue on PropertyInfo void GetString<T>(string input, T target, Expression<Func<T, string>> outExpr) { if (!string.IsNullOrEmpty(input)) { var expr = (MemberExpression) outExpr.Body; var prop = (PropertyInfo) expr.Member; prop.SetValue(target, input, null); } } void Main() { var person = new Person(); GetString(\"test\", person, x => x.Name); Debug.Assert(person.Name == \"test\"); }","title":"MemberExpression"},{"location":"CSharp/MemberExpression/#use-memberexpression-and-propertyinfo-to-get-objects-property-to-work-on","text":"","title":"Use MemberExpression and PropertyInfo to get object's property to work on"},{"location":"CSharp/MemberExpression/#get-propertys-custom-annotation","text":"using System; using System.ComponentModel; using System.Linq.Expressions; public class Foo { [Description( \"The first property.\" )] public int property1; [Description( \"The second property.\" )] public string property2; } class Program { static string GetDescription<T>( Expression<Func<T>> expr ) { var mexpr = expr.Body as MemberExpression; if( mexpr == null ) return null; if( mexpr.Member == null ) return null; object[] attrs = mexpr.Member.GetCustomAttributes( typeof( DescriptionAttribute ), false ); if( attrs == null || attrs.Length == 0 ) return null; DescriptionAttribute desc = attrs[0] as DescriptionAttribute; if( desc == null ) return null; return desc.Description; } static void Main( string[] args ) { Foo foo = new Foo(); Console.WriteLine( GetDescription( () => foo.property1 ) ); Console.WriteLine( GetDescription( () => foo.property2 ) ); } }","title":"Get property's custom annotation"},{"location":"CSharp/MemberExpression/#use-memberexpression-and-compile-to-get-the-value","text":"public static string Meth<T>(Expression<Func<T>> expression) { var name = ((MemberExpression)expression.Body).Member.Name; var value = expression.Compile()(); return string.Format(\"{0} - {1}\", name, value); } Meth(() => YourObject.Property);","title":"Use MemberExpression and Compile to get the value"},{"location":"CSharp/MemberExpression/#use-getvalue-and-setvalue-on-propertyinfo","text":"void GetString<T>(string input, T target, Expression<Func<T, string>> outExpr) { if (!string.IsNullOrEmpty(input)) { var expr = (MemberExpression) outExpr.Body; var prop = (PropertyInfo) expr.Member; prop.SetValue(target, input, null); } } void Main() { var person = new Person(); GetString(\"test\", person, x => x.Name); Debug.Assert(person.Name == \"test\"); }","title":"Use getValue and setValue on PropertyInfo"},{"location":"DockerSwarm/","text":"Docker Swarm Stack with Traefik solution Docker Swarm Stack with Traefik solution Architect diagram High level explanation Traefik service act as load-balancer Frontier service example Backtier service example Steps to deploy and test Architect diagram High level explanation Lets say you have 8 VM Nodes showing as the Gray Box in the diagram above You plan to build a few fronttier web applications One web UI app written in TS or JS listening on port 5001 One Web REST API app writtern in DotNet Core listening on port 5002 One web GraphQL API app writtern in Javascript listening on port 5003 You want to use the following URL to access these services Web UI app: http://yourdomain.com/www REST API app: http://yourdomain.com/api GraphQL API app: http://yourdomain.com/graphql Traefik instance here can help, it works just like a reverse proxy. So based on a frontend rule like \"traefik.frontend.rule=PathPrefixStrip:/www , it will allow the request to be redirected/forwared to the backend service for the Web UI app This will be the same for backtier applications. You might want to run a few backtier app too One backend OSS app listening on port 60001 One backend Billing app listening on port 60002 One backend media app listing on port 60003 You want to access them from the fronttier containers using URL like these: Backend OSS app: http://backtier/oss/v1 Backend Billing app: http://backtier/billing/v1 Backend Media app: http://backtier/media/v1 Backend Media app version 2: http://backtier/media/v2 Now we need a 2nd Traefik instance to handle these ones Both of these 2 Traefik instances will listen on port 80 and 443, but only the fronttier Traefik instance docker container exposed/mapped to Node port 80 and 443, the backtier mapped to different ports or simply no need to map to Node Ports All the frontend containers can use http://backtier to access the backtier Traefik service anyway. Because we allow any container to deploy on any hosts to provide maximum flexibility, we will use a trick to differentiate which contains should be managed by which Traefik instance The way to achieve that is to use a tag on the Traefik service like \"--constraints=tag==traefik-fronttier\" All the containers with a tag like traefik-tags=traefik-fronttier will be associated only to the \"fronttier\" Traefik instance The same type of config works for backtier apps as well. Traefik service act as load-balancer There are 2 Traefik instances to handle both fronttier and backtier services Note: \"--constraints=tag==traefik-fronttier\" controls only the containers with traefik-tags=traefik-fronttier tags will be controlled by the fronttier traefik controller \"--constraints=tag==traefik-backtier\" controls only the containers with traefik-tags=traefik-backtier tags will be controlled by the backtier traefik controller restart_policy set to condition: any will allow these 2 traefik container/service to auto restart after node reboot or docker daemon reboot. constraints: [node.role == manager] will force these 2 traefik services to run only on Swarm Manager role nodes version: '3.3' networks: frontend: driver: overlay attachable: true volumes: data: services: fronttier: image: devmr1oktodock1:5000/traefik:1.7 command: - \"--docker\" - \"--docker.swarmmode=true\" - \"--docker.domain=docker.localhost\" - \"--docker.watch=true\" - \"--docker.exposedbydefault=true\" - \"--docker.endpoint=unix:///var/run/docker.sock\" - \"--constraints=tag==traefik-fronttier\" - \"--web\" ports: - \"80:80\" # The HTTP port - \"443:443\" - \"8000:8080\" # API volumes: - /var/run/docker.sock:/var/run/docker.sock # So that Traefik can listen to the Docker events networks: - frontend labels: - \"traefik.enable=false\" deploy: placement: constraints: [node.role == manager] restart_policy: #condition: on-failure condition: any backtier: image: devmr1oktodock1:5000/traefik:1.7 command: - \"--docker\" - \"--docker.swarmmode=true\" - \"--docker.domain=docker.localhost\" - \"--docker.watch=true\" - \"--docker.exposedbydefault=true\" - \"--docker.endpoint=unix:///var/run/docker.sock\" - \"--constraints=tag==traefik-backtier\" - \"--web\" - \"--loglevel=DEBUG\" ports: - \"7180:80\" # The HTTP port - \"7443:443\" - \"7880:8080\" # API volumes: - /var/run/docker.sock:/var/run/docker.sock # So that Traefik can listen to the Docker events networks: - frontend labels: - \"traefik.enable=false\" deploy: placement: constraints: [node.role == manager] restart_policy: condition: any Frontier service example The following simulate a simple fronttier webapp Note: extra_hosts are the list of the hosts Docker will put them into the container's /etc/hosts file This sample lists external IP for the redis , mongodb and consul services. extra_hosts will allow apps in docker container to communicate to external services constraints: - node.role == worker set the service contains to run only in nodes whose role is a worker - \"traefik.basic.port=5000\" this is the port for our webapp:1.1 service. This webapp listens and exposes on port 5000 - \"traefik.frontend.rule=PathPrefixStrip:/webapp\" this is Traefik setting for URL mapping. Any request to /webapp will be forwarded to port 5000 (the webapp service itself) \"traefik.backend=webapp\" set the name of the service Traefik will forward the request to, which is the service itself - \"traefik.docker.network=okto_frontend\" this is the Docker overlay network which Traefik and all services use to communicate - \"traefik.tags=traefik-fronttier\" is to set the webapp service to associate with the traefik-fronttier Traefik instance version: \"3.3\" services: webapp: image: devmr1oktodock1:5000/webapp:1.1 extra_hosts: - \"redis:172.25.83.76\" - \"mongodb:172.25.83.64\" - \"consul:172.25.83.61\" networks: - frontend deploy: placement: constraints: - node.role == worker restart_policy: condition: on-failure labels: - \"traefik.enable=true\" - \"traefik.basic.port=5000\" - \"traefik.basic.protocol=http\" - \"traefik.backend=webapp\" - \"traefik.frontend.rule=PathPrefixStrip:/webapp\" - \"traefik.docker.network=okto_frontend\" - \"traefik.backend.loadbalancer.swarm=true\" - \"traefik.tags=traefik-fronttier\" Backtier service example whoami: image: devmr1oktodock1:5000/whoami:latest extra_hosts: - \"redis:172.25.83.76\" - \"mongodb:172.25.83.64\" - \"consul:172.25.83.61\" networks: - frontend deploy: placement: constraints: - node.role == worker restart_policy: condition: on-failure labels: - \"traefik.enable=true\" - \"traefik.basic.port=80\" - \"traefik.basic.protocol=http\" - \"traefik.backend=whoami\" - \"traefik.frontend.rule=PathPrefixStrip:/whoami\" - \"traefik.docker.network=okto_frontend\" - \"traefik.backend.loadbalancer.swarm=true\" - \"traefik.tags=traefik-backtier\" networks: frontend: driver: overlay attachable: true Steps to deploy and test #Run this to deploy docker stack deploy -c docker-traefik-without-local-volumn.yml okto #Check if 2 instance's API interface (it was started using the --web flag in the yml) curl --noproxy '*' http://devmr1oktodock1:8000/api curl --noproxy '*' http://devmr1oktodock1:7880/api Once these 2 Traefik instances are running well, deploy both fronttier and backtier apps #Run this to deploy docker stack deploy -c docker-webapp.yml okto #Check the services curl --noproxy '*' http://devmr1oktodock1/webapp curl --noproxy '*' http://devmr1oktodock1:7180/whoami The following commands will scale the services to run multiple instances then check their status [root@devmr1oktodock1 multiple-traefik-stack]# docker service scale okto_webapp=3 okto_webapp scaled to 3 overall progress: 3 out of 3 tasks 1/3: running [==================================================>] 2/3: running [==================================================>] 3/3: running [==================================================>] verify: Service converged [root@devmr1oktodock1 multiple-traefik-stack]# docker service ps okto_webapp ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS ldae6tup6v8s okto_webapp.1 devmr1oktodock1:5000/webapp:1.1 devmr1oktodock3.br.devrep.tv.telus.net Running Running 37 minutes ago etexcwod5tux okto_webapp.2 devmr1oktodock1:5000/webapp:1.1 devmr1oktodock3.br.devrep.tv.telus.net Running Running 14 seconds ago klopqgsbw2pe okto_webapp.3 devmr1oktodock1:5000/webapp:1.1 devmr1oktodock3.br.devrep.tv.telus.net Running Running 14 seconds ago [root@devmr1oktodock1 multiple-traefik-stack]# docker service ps okto_whoami ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS ojzt1rgpxx4i okto_whoami.1 devmr1oktodock1:5000/whoami:latest devmr1oktodock2.br.devrep.tv.telus.net Running Running 10 minutes ago ji9aga2xq4e0 okto_whoami.2 devmr1oktodock1:5000/whoami:latest devmr1oktodock1.br.devrep.tv.telus.net Running Running 9 minutes ago jbnkom5oiv2a okto_whoami.3 devmr1oktodock1:5000/whoami:latest devmr1oktodock3.br.devrep.tv.telus.net Running Running 9 minutes ago ww7315qshpzd okto_whoami.4 devmr1oktodock1:5000/whoami:latest devmr1oktodock3.br.devrep.tv.telus.net Running Running 9 minutes ago","title":"DockerSwarm"},{"location":"DockerSwarm/#docker-swarm-stack-with-traefik-solution","text":"Docker Swarm Stack with Traefik solution Architect diagram High level explanation Traefik service act as load-balancer Frontier service example Backtier service example Steps to deploy and test","title":"Docker Swarm Stack with Traefik solution"},{"location":"DockerSwarm/#architect-diagram","text":"","title":"Architect diagram"},{"location":"DockerSwarm/#high-level-explanation","text":"Lets say you have 8 VM Nodes showing as the Gray Box in the diagram above You plan to build a few fronttier web applications One web UI app written in TS or JS listening on port 5001 One Web REST API app writtern in DotNet Core listening on port 5002 One web GraphQL API app writtern in Javascript listening on port 5003 You want to use the following URL to access these services Web UI app: http://yourdomain.com/www REST API app: http://yourdomain.com/api GraphQL API app: http://yourdomain.com/graphql Traefik instance here can help, it works just like a reverse proxy. So based on a frontend rule like \"traefik.frontend.rule=PathPrefixStrip:/www , it will allow the request to be redirected/forwared to the backend service for the Web UI app This will be the same for backtier applications. You might want to run a few backtier app too One backend OSS app listening on port 60001 One backend Billing app listening on port 60002 One backend media app listing on port 60003 You want to access them from the fronttier containers using URL like these: Backend OSS app: http://backtier/oss/v1 Backend Billing app: http://backtier/billing/v1 Backend Media app: http://backtier/media/v1 Backend Media app version 2: http://backtier/media/v2 Now we need a 2nd Traefik instance to handle these ones Both of these 2 Traefik instances will listen on port 80 and 443, but only the fronttier Traefik instance docker container exposed/mapped to Node port 80 and 443, the backtier mapped to different ports or simply no need to map to Node Ports All the frontend containers can use http://backtier to access the backtier Traefik service anyway. Because we allow any container to deploy on any hosts to provide maximum flexibility, we will use a trick to differentiate which contains should be managed by which Traefik instance The way to achieve that is to use a tag on the Traefik service like \"--constraints=tag==traefik-fronttier\" All the containers with a tag like traefik-tags=traefik-fronttier will be associated only to the \"fronttier\" Traefik instance The same type of config works for backtier apps as well.","title":"High level explanation"},{"location":"DockerSwarm/#traefik-service-act-as-load-balancer","text":"There are 2 Traefik instances to handle both fronttier and backtier services Note: \"--constraints=tag==traefik-fronttier\" controls only the containers with traefik-tags=traefik-fronttier tags will be controlled by the fronttier traefik controller \"--constraints=tag==traefik-backtier\" controls only the containers with traefik-tags=traefik-backtier tags will be controlled by the backtier traefik controller restart_policy set to condition: any will allow these 2 traefik container/service to auto restart after node reboot or docker daemon reboot. constraints: [node.role == manager] will force these 2 traefik services to run only on Swarm Manager role nodes version: '3.3' networks: frontend: driver: overlay attachable: true volumes: data: services: fronttier: image: devmr1oktodock1:5000/traefik:1.7 command: - \"--docker\" - \"--docker.swarmmode=true\" - \"--docker.domain=docker.localhost\" - \"--docker.watch=true\" - \"--docker.exposedbydefault=true\" - \"--docker.endpoint=unix:///var/run/docker.sock\" - \"--constraints=tag==traefik-fronttier\" - \"--web\" ports: - \"80:80\" # The HTTP port - \"443:443\" - \"8000:8080\" # API volumes: - /var/run/docker.sock:/var/run/docker.sock # So that Traefik can listen to the Docker events networks: - frontend labels: - \"traefik.enable=false\" deploy: placement: constraints: [node.role == manager] restart_policy: #condition: on-failure condition: any backtier: image: devmr1oktodock1:5000/traefik:1.7 command: - \"--docker\" - \"--docker.swarmmode=true\" - \"--docker.domain=docker.localhost\" - \"--docker.watch=true\" - \"--docker.exposedbydefault=true\" - \"--docker.endpoint=unix:///var/run/docker.sock\" - \"--constraints=tag==traefik-backtier\" - \"--web\" - \"--loglevel=DEBUG\" ports: - \"7180:80\" # The HTTP port - \"7443:443\" - \"7880:8080\" # API volumes: - /var/run/docker.sock:/var/run/docker.sock # So that Traefik can listen to the Docker events networks: - frontend labels: - \"traefik.enable=false\" deploy: placement: constraints: [node.role == manager] restart_policy: condition: any","title":"Traefik service act as load-balancer"},{"location":"DockerSwarm/#frontier-service-example","text":"The following simulate a simple fronttier webapp Note: extra_hosts are the list of the hosts Docker will put them into the container's /etc/hosts file This sample lists external IP for the redis , mongodb and consul services. extra_hosts will allow apps in docker container to communicate to external services constraints: - node.role == worker set the service contains to run only in nodes whose role is a worker - \"traefik.basic.port=5000\" this is the port for our webapp:1.1 service. This webapp listens and exposes on port 5000 - \"traefik.frontend.rule=PathPrefixStrip:/webapp\" this is Traefik setting for URL mapping. Any request to /webapp will be forwarded to port 5000 (the webapp service itself) \"traefik.backend=webapp\" set the name of the service Traefik will forward the request to, which is the service itself - \"traefik.docker.network=okto_frontend\" this is the Docker overlay network which Traefik and all services use to communicate - \"traefik.tags=traefik-fronttier\" is to set the webapp service to associate with the traefik-fronttier Traefik instance version: \"3.3\" services: webapp: image: devmr1oktodock1:5000/webapp:1.1 extra_hosts: - \"redis:172.25.83.76\" - \"mongodb:172.25.83.64\" - \"consul:172.25.83.61\" networks: - frontend deploy: placement: constraints: - node.role == worker restart_policy: condition: on-failure labels: - \"traefik.enable=true\" - \"traefik.basic.port=5000\" - \"traefik.basic.protocol=http\" - \"traefik.backend=webapp\" - \"traefik.frontend.rule=PathPrefixStrip:/webapp\" - \"traefik.docker.network=okto_frontend\" - \"traefik.backend.loadbalancer.swarm=true\" - \"traefik.tags=traefik-fronttier\"","title":"Frontier service example"},{"location":"DockerSwarm/#backtier-service-example","text":"whoami: image: devmr1oktodock1:5000/whoami:latest extra_hosts: - \"redis:172.25.83.76\" - \"mongodb:172.25.83.64\" - \"consul:172.25.83.61\" networks: - frontend deploy: placement: constraints: - node.role == worker restart_policy: condition: on-failure labels: - \"traefik.enable=true\" - \"traefik.basic.port=80\" - \"traefik.basic.protocol=http\" - \"traefik.backend=whoami\" - \"traefik.frontend.rule=PathPrefixStrip:/whoami\" - \"traefik.docker.network=okto_frontend\" - \"traefik.backend.loadbalancer.swarm=true\" - \"traefik.tags=traefik-backtier\" networks: frontend: driver: overlay attachable: true","title":"Backtier service example"},{"location":"DockerSwarm/#steps-to-deploy-and-test","text":"#Run this to deploy docker stack deploy -c docker-traefik-without-local-volumn.yml okto #Check if 2 instance's API interface (it was started using the --web flag in the yml) curl --noproxy '*' http://devmr1oktodock1:8000/api curl --noproxy '*' http://devmr1oktodock1:7880/api Once these 2 Traefik instances are running well, deploy both fronttier and backtier apps #Run this to deploy docker stack deploy -c docker-webapp.yml okto #Check the services curl --noproxy '*' http://devmr1oktodock1/webapp curl --noproxy '*' http://devmr1oktodock1:7180/whoami The following commands will scale the services to run multiple instances then check their status [root@devmr1oktodock1 multiple-traefik-stack]# docker service scale okto_webapp=3 okto_webapp scaled to 3 overall progress: 3 out of 3 tasks 1/3: running [==================================================>] 2/3: running [==================================================>] 3/3: running [==================================================>] verify: Service converged [root@devmr1oktodock1 multiple-traefik-stack]# docker service ps okto_webapp ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS ldae6tup6v8s okto_webapp.1 devmr1oktodock1:5000/webapp:1.1 devmr1oktodock3.br.devrep.tv.telus.net Running Running 37 minutes ago etexcwod5tux okto_webapp.2 devmr1oktodock1:5000/webapp:1.1 devmr1oktodock3.br.devrep.tv.telus.net Running Running 14 seconds ago klopqgsbw2pe okto_webapp.3 devmr1oktodock1:5000/webapp:1.1 devmr1oktodock3.br.devrep.tv.telus.net Running Running 14 seconds ago [root@devmr1oktodock1 multiple-traefik-stack]# docker service ps okto_whoami ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS ojzt1rgpxx4i okto_whoami.1 devmr1oktodock1:5000/whoami:latest devmr1oktodock2.br.devrep.tv.telus.net Running Running 10 minutes ago ji9aga2xq4e0 okto_whoami.2 devmr1oktodock1:5000/whoami:latest devmr1oktodock1.br.devrep.tv.telus.net Running Running 9 minutes ago jbnkom5oiv2a okto_whoami.3 devmr1oktodock1:5000/whoami:latest devmr1oktodock3.br.devrep.tv.telus.net Running Running 9 minutes ago ww7315qshpzd okto_whoami.4 devmr1oktodock1:5000/whoami:latest devmr1oktodock3.br.devrep.tv.telus.net Running Running 9 minutes ago","title":"Steps to deploy and test"},{"location":"Kubernetes/KubernetesNotes/","text":"Notes","title":"Kubernetes"},{"location":"Kubernetes/KubernetesNotes/#notes","text":"","title":"Notes"},{"location":"Powershell/","text":"Powershell Note Powershell Note Awsome Powershell and other useful sites [Powershell Modules Note](Module.md) Awsome Powershell and other useful sites Awsome Powershell Powershell Modules Note Powershell Functions","title":"Powershell Note"},{"location":"Powershell/#powershell-note","text":"Powershell Note Awsome Powershell and other useful sites [Powershell Modules Note](Module.md)","title":"Powershell Note"},{"location":"Powershell/#awsome-powershell-and-other-useful-sites","text":"Awsome Powershell","title":"Awsome Powershell and other useful sites"},{"location":"Powershell/#powershell-modules-note","text":"","title":"Powershell Modules Note"},{"location":"Powershell/#powershell-functions","text":"","title":"Powershell Functions"},{"location":"Powershell/Functions/","text":"Powershell functions notes Powershell functions notes ParameterSet and CmdletBinding Use Invoke-RestMethod to get GitHubOAuth Token ParameterSet and CmdletBinding Notable points: DefaultParameterSetName [Parameter(Mandatory = $false, Position=0, ParameterSetName='repo')] [ValidatePattern('^*$|^none$|^.+$')] [ValidateSet('open', 'closed')] function Get-GitHubIssues { [CmdletBinding(DefaultParameterSetName='repo')] param( [Parameter(Mandatory = $false, Position=0, ParameterSetName='repo')] [string] $Owner = $null, [Parameter(Mandatory = $false, Position=1, ParameterSetName='repo')] [string] $Repository = $null, [Parameter(Mandatory = $false, ParameterSetName='user')] [switch] $ForUser, [Parameter(Mandatory = $false)] [ValidateSet('open', 'closed')] $State = 'open', [Parameter(Mandatory = $false, ParameterSetName='user')] [ValidateSet('assigned', 'created', 'mentioned', 'subscribed')] $Filter = 'assigned', [Parameter(Mandatory = $false, ParameterSetName='repo')] [ValidatePattern('^\\*$|^none$|^\\d+$')] $Milestone, [Parameter(Mandatory = $false, ParameterSetName='repo')] [ValidatePattern('^\\*$|^none$|^.+$')] $Assignee, [Parameter(Mandatory = $false, ParameterSetName='repo')] [string] $Creator, [Parameter(Mandatory = $false, ParameterSetName='repo')] [string] $Mentioned, [Parameter(Mandatory = $false)] [string[]] $Labels = @(), [Parameter(Mandatory = $false)] [ValidateSet('created', 'updated', 'comments')] $Sort = 'created', [Parameter(Mandatory = $false)] [ValidateSet('asc', 'desc')] $Direction = 'desc', [Parameter(Mandatory = $false)] [DateTime] #Optional string of a timestamp in ISO 8601 format: YYYY-MM-DDTHH:MM:SSZ $Since ) Use Invoke-RestMethod to get GitHubOAuth Token it's using basic auth, use GetBytes to convert string to bytes then use ToBase64String to convert them to base64 string function Get-GitHubOAuthTokens { [CmdletBinding()] param( [Parameter(Mandatory = $true)] [string] $UserName, [Parameter(Mandatory = $true)] [string] $Password ) try { $params = @{ Uri = 'https://api.github.com/authorizations'; Headers = @{ Authorization = 'Basic ' + [Convert]::ToBase64String( [Text.Encoding]::ASCII.GetBytes(\"$($userName):$($password)\")); } } $global:GITHUB_API_OUTPUT = Invoke-RestMethod @params #Write-Verbose $global:GITHUB_API_OUTPUT $global:GITHUB_API_OUTPUT | % { $date = [DateTime]::Parse($_.created_at).ToString('g') Write-Host \"`n$($_.app.name) - Created $date\" Write-Host \"`t$($_.token)`n`t$($_.app.url)\" } } catch { Write-Error \"An unexpected error occurred (bad user/password?) $($Error[0])\" } }","title":"PS Functions Note"},{"location":"Powershell/Functions/#powershell-functions-notes","text":"Powershell functions notes ParameterSet and CmdletBinding Use Invoke-RestMethod to get GitHubOAuth Token","title":"Powershell functions notes"},{"location":"Powershell/Functions/#parameterset-and-cmdletbinding","text":"Notable points: DefaultParameterSetName [Parameter(Mandatory = $false, Position=0, ParameterSetName='repo')] [ValidatePattern('^*$|^none$|^.+$')] [ValidateSet('open', 'closed')] function Get-GitHubIssues { [CmdletBinding(DefaultParameterSetName='repo')] param( [Parameter(Mandatory = $false, Position=0, ParameterSetName='repo')] [string] $Owner = $null, [Parameter(Mandatory = $false, Position=1, ParameterSetName='repo')] [string] $Repository = $null, [Parameter(Mandatory = $false, ParameterSetName='user')] [switch] $ForUser, [Parameter(Mandatory = $false)] [ValidateSet('open', 'closed')] $State = 'open', [Parameter(Mandatory = $false, ParameterSetName='user')] [ValidateSet('assigned', 'created', 'mentioned', 'subscribed')] $Filter = 'assigned', [Parameter(Mandatory = $false, ParameterSetName='repo')] [ValidatePattern('^\\*$|^none$|^\\d+$')] $Milestone, [Parameter(Mandatory = $false, ParameterSetName='repo')] [ValidatePattern('^\\*$|^none$|^.+$')] $Assignee, [Parameter(Mandatory = $false, ParameterSetName='repo')] [string] $Creator, [Parameter(Mandatory = $false, ParameterSetName='repo')] [string] $Mentioned, [Parameter(Mandatory = $false)] [string[]] $Labels = @(), [Parameter(Mandatory = $false)] [ValidateSet('created', 'updated', 'comments')] $Sort = 'created', [Parameter(Mandatory = $false)] [ValidateSet('asc', 'desc')] $Direction = 'desc', [Parameter(Mandatory = $false)] [DateTime] #Optional string of a timestamp in ISO 8601 format: YYYY-MM-DDTHH:MM:SSZ $Since )","title":"ParameterSet and CmdletBinding"},{"location":"Powershell/Functions/#use-invoke-restmethod-to-get-githuboauth-token","text":"it's using basic auth, use GetBytes to convert string to bytes then use ToBase64String to convert them to base64 string function Get-GitHubOAuthTokens { [CmdletBinding()] param( [Parameter(Mandatory = $true)] [string] $UserName, [Parameter(Mandatory = $true)] [string] $Password ) try { $params = @{ Uri = 'https://api.github.com/authorizations'; Headers = @{ Authorization = 'Basic ' + [Convert]::ToBase64String( [Text.Encoding]::ASCII.GetBytes(\"$($userName):$($password)\")); } } $global:GITHUB_API_OUTPUT = Invoke-RestMethod @params #Write-Verbose $global:GITHUB_API_OUTPUT $global:GITHUB_API_OUTPUT | % { $date = [DateTime]::Parse($_.created_at).ToString('g') Write-Host \"`n$($_.app.name) - Created $date\" Write-Host \"`t$($_.token)`n`t$($_.app.url)\" } } catch { Write-Error \"An unexpected error occurred (bad user/password?) $($Error[0])\" } }","title":"Use Invoke-RestMethod to get GitHubOAuth Token"},{"location":"Powershell/Module/","text":"PS Modules Use Set-Alias to link function in module to a script Typically, functions are in the psm1 file but you can write in regular script files then use Set-Alias to link them in the psm1 module file Set-Alias -Name Build-Checkpoint -Value (Join-Path $PSScriptRoot Build-Checkpoint.ps1) Set-Alias -Name Build-Parallel -Value (Join-Path $PSScriptRoot Build-Parallel.ps1) Set-Alias -Name Invoke-Build -Value (Join-Path $PSScriptRoot Invoke-Build.ps1) Export-ModuleMember -Alias Build-Checkpoint, Build-Parallel, Invoke-Build Import all function scripts in a folder This snipet is from PSSlack.psm1 #Get public and private function definition files. $Public = @( Get-ChildItem -Path $PSScriptRoot\\Public\\*.ps1 -ErrorAction SilentlyContinue ) $Private = @( Get-ChildItem -Path $PSScriptRoot\\Private\\*.ps1 -ErrorAction SilentlyContinue ) $ModuleRoot = $PSScriptRoot #Dot source the files Foreach($import in @($Public + $Private)) { Try { . $import.fullname } Catch { Write-Error -Message \"Failed to import function $($import.fullname): $_\" } } Beginning in PowerShell 3.0, there is a new automatic variable available called $PSScriptRoot. This variable previously was only available within modules. It always points to the folder the current script is located in (so it only starts to be useful once you actually save a script before you run it). You can use $PSScriptRoot to load additional resources relative to your script location. For example, if you decide to place some functions in a separate \"library\" script that is located in the same folder, this would load the library script and import all of its functions The following snipet handles PS v2 situation #handle PS2 if(-not $PSScriptRoot) { $PSScriptRoot = Split-Path $MyInvocation.MyCommand.Path -Parent } Export functions # $Public is an array imported above Export-ModuleMember -Function $Public.Basename -Variable _PSSlackColorMap Export using wild-cards Export-ModuleMember -Function 'Get-*'","title":"PS Modules Note"},{"location":"Powershell/Module/#ps-modules","text":"","title":"PS Modules"},{"location":"Powershell/Module/#use-set-alias-to-link-function-in-module-to-a-script","text":"Typically, functions are in the psm1 file but you can write in regular script files then use Set-Alias to link them in the psm1 module file Set-Alias -Name Build-Checkpoint -Value (Join-Path $PSScriptRoot Build-Checkpoint.ps1) Set-Alias -Name Build-Parallel -Value (Join-Path $PSScriptRoot Build-Parallel.ps1) Set-Alias -Name Invoke-Build -Value (Join-Path $PSScriptRoot Invoke-Build.ps1) Export-ModuleMember -Alias Build-Checkpoint, Build-Parallel, Invoke-Build","title":"Use Set-Alias to link function in module to a script"},{"location":"Powershell/Module/#import-all-function-scripts-in-a-folder","text":"This snipet is from PSSlack.psm1 #Get public and private function definition files. $Public = @( Get-ChildItem -Path $PSScriptRoot\\Public\\*.ps1 -ErrorAction SilentlyContinue ) $Private = @( Get-ChildItem -Path $PSScriptRoot\\Private\\*.ps1 -ErrorAction SilentlyContinue ) $ModuleRoot = $PSScriptRoot #Dot source the files Foreach($import in @($Public + $Private)) { Try { . $import.fullname } Catch { Write-Error -Message \"Failed to import function $($import.fullname): $_\" } } Beginning in PowerShell 3.0, there is a new automatic variable available called $PSScriptRoot. This variable previously was only available within modules. It always points to the folder the current script is located in (so it only starts to be useful once you actually save a script before you run it). You can use $PSScriptRoot to load additional resources relative to your script location. For example, if you decide to place some functions in a separate \"library\" script that is located in the same folder, this would load the library script and import all of its functions The following snipet handles PS v2 situation #handle PS2 if(-not $PSScriptRoot) { $PSScriptRoot = Split-Path $MyInvocation.MyCommand.Path -Parent }","title":"Import all function scripts in a folder"},{"location":"Powershell/Module/#export-functions","text":"# $Public is an array imported above Export-ModuleMember -Function $Public.Basename -Variable _PSSlackColorMap Export using wild-cards Export-ModuleMember -Function 'Get-*'","title":"Export functions"},{"location":"Sites/","text":"Interesting Sites Interesting Sites CMSWing PDMan \u6570\u636e\u5e93\u5efa\u6a21 Dotjs a simple template CMSWing \u4e00\u6b3e\u57fa\u4e8eThinkJS(Node.js MVC)\u548cMySQL\u7684\u529f\u80fd\u5f3a\u5927\u7684\uff08PC\u7aef,\u624b\u673a\u7aef\u548c\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\uff09\u7535\u5b50\u5546\u52a1\u5e73\u53f0\u53caCMS\u5efa\u7ad9\u7cfb\u7edf https://github.com/arterli/CmsWing PDMan \u6570\u636e\u5e93\u5efa\u6a21 https://gitee.com/robergroup/pdman Dotjs a simple template Dotjs","title":"Sites"},{"location":"Sites/#interesting-sites","text":"Interesting Sites CMSWing PDMan \u6570\u636e\u5e93\u5efa\u6a21 Dotjs a simple template","title":"Interesting Sites"},{"location":"Sites/#cmswing","text":"\u4e00\u6b3e\u57fa\u4e8eThinkJS(Node.js MVC)\u548cMySQL\u7684\u529f\u80fd\u5f3a\u5927\u7684\uff08PC\u7aef,\u624b\u673a\u7aef\u548c\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\uff09\u7535\u5b50\u5546\u52a1\u5e73\u53f0\u53caCMS\u5efa\u7ad9\u7cfb\u7edf https://github.com/arterli/CmsWing","title":"CMSWing"},{"location":"Sites/#pdman","text":"https://gitee.com/robergroup/pdman","title":"PDMan \u6570\u636e\u5e93\u5efa\u6a21"},{"location":"Sites/#dotjs-a-simple-template","text":"Dotjs","title":"Dotjs a simple template"}]}